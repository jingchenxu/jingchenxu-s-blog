# 微信商城重构体验

date: 2018-10-31

* 为什么要重构

这个算是我独立完成的第一个前端项目，最开始使用的时react技术栈，大概是2年前，所以react的版本有点老旧了，项目的基础框架是自己搭建的没有使用cli工具生成，可以概括点来说有以下的几宗罪：

1. react版本老旧，前端发展过快；
2. 没有使用redux这样的前端数据管理框架，滥用全局变量，再原有基础上重构困难；
3. 全局的状态管理使用的事件监听的模式；
4. 代码结构混乱，如果后面的人接手会比较困难；
5. 当时还没有npm.lock,有些包会自动升级；
6. SPA的路由会对微信的支付功能造成一些影响；
7. 调试不方便；
8. 该项目体量小，且未来还会持续运营，会在现有功能上做一些扩展。

基于以上的原因，我决定乘这次系统扩展的机会彻底重构该项目，预计半个月的时间，这次重构玩，正好可以交付测试进行测试，避免因重构导致上线异常。

* 选择何种开发模式

经过3年的web开发，发现了后台管理系统可能更适合采用SPA的开发模式进行开发，而对于商城这样的系统，或与采用jsp,或是其它的模板引擎进行开发更好，当然作为新时代的前端使用jsp并不是意味着我们要回到jquery的时代，在dom的操作上我们可以完全使用vue替代jquery，没有了dom操作我们可以少些很多代码，最后我选择的开发模式是jsp+vue，jsp负责路由，而vue负责页面的渲染。

* 重构的步骤

1. 确定项目结构：


