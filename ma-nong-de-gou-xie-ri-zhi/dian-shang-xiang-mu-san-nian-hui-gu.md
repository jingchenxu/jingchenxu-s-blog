# 电商项目三年回顾

> 虽说这个电商项目不是全程参与的，中间有段时间参加到公司的其他项目当中，但是最后当初的项目经理走了，项目最后竟然落到我的手里，一坨坨陈年代码浮现在我的眼前。

## 项目架构

## 关于表结构相关

三年之中出现了大概有三次的生产环境事故，这三次事故都是数据库服务器CPU异常，应用服务器的异常倒是比较少，代码虽然丑，但是也只是有些内存溢出，基于运维到目前的运维问题，总结了一下几点：

* 每张表尽可能的设置唯一主键，如果不能设置唯一主键，那就设置联合主键，对于像在用户表中的手机号码，微信openid之类的必然唯一的数据，设置唯一索引；
* 如果是电商项目还是减少存储过程的使用吧！关于存储过程的维护会是个很大的问题，尽可能的通过在mybatis中编写SQL语句实现；
* 针对于SpringMVC的电商项目，每个DAO方法都应该是单一职能的，尽量保证一个功能复杂的DAO方法（修改多个字段数据的DAO方法）只被一处引用，如果只修改一个字段的数据，则需要取一个好的DAO方法名称；
* 一定要设置连接池的大小，三次生产环境的数据库服务器CPU异常，其实都是数据库连接过多导致的；
* 注意事务的使用，查询是不需要使用事务的，事务是为了使数据的一致性得到保证，在对多个数据表进行数据操作时，为了保证数据的一致性需要使用事务，事务的使用会导致数据库服务器CPU上升。

## 关于生产环境的测试

生产环境的测试是一个大问题，现在有很多的手段来保证生产环境与开发环境的一致性，但是我们还是会在很多时候听到这样的话“我本地是好的”，但是生产环境都是正式数据，务必要十分小心，关于生产环境的测试应该从项目的开发之初就应该考虑到的问题。

* 
